<!DOCTYPE html>
<html>
<link href="https://fonts.cdnfonts.com/css/public-pixel" rel="stylesheet">
<body>
<style>

#game {
	margin-top: 30px;
	height: 350px;
    width: 350px;
    background-color: lightgrey;
    float: left;
    border: solid black 25px;
    color: transparent;
}

.pixel {
	height: 35px;
    width: 35px;
    float: left;
}

.background {
	background-size: contain;
	background-repeat: no-repeat;
    height: 35px;
    width: 35px;
    
    margin-left: 4px;
}

.orginal-left {
    background-image: url("http://moviewatchlist.weebly.com/uploads/8/6/4/2/86429426/orginal-l_orig.png"); 
}

.orginal-right {
    background-image: url("http://moviewatchlist.weebly.com/uploads/8/6/4/2/86429426/orginal-r_orig.png"); 
}

.orginal-up {
    background-image: url("https://moviewatchlist.weebly.com/uploads/8/6/4/2/86429426/orginal-back_orig.png"); 
}

.orginal-down {
    background-image: url("http://moviewatchlist.weebly.com/uploads/8/6/4/2/86429426/orginal_orig.png"); 
}

.red-left {
    background-image: url("http://moviewatchlist.weebly.com/uploads/8/6/4/2/86429426/red-l_orig.png"); 
}

.red-right {
    background-image: url("http://moviewatchlist.weebly.com/uploads/8/6/4/2/86429426/red-r_orig.png"); 
}

.red-up {
    background-image: url("http://moviewatchlist.weebly.com/uploads/8/6/4/2/86429426/red-back_orig.png"); 
}

.red-down {
    background-image: url("http://moviewatchlist.weebly.com/uploads/8/6/4/2/86429426/red_orig.png"); 
}

.blue-left {
    background-image: url("https://moviewatchlist.weebly.com/uploads/8/6/4/2/86429426/blue-l_orig.png"); 
}

.blue-right {
    background-image: url("https://moviewatchlist.weebly.com/uploads/8/6/4/2/86429426/blue-r_orig.png"); 
}

.blue-up {
    background-image: url("https://moviewatchlist.weebly.com/uploads/8/6/4/2/86429426/blue-back_orig.png"); 
}

.blue-down {
    background-image: url("https://moviewatchlist.weebly.com/uploads/8/6/4/2/86429426/blue_orig.png"); 
}

.green-left {
    background-image: url("https://moviewatchlist.weebly.com/uploads/8/6/4/2/86429426/green-l_orig.png"); 
}

.green-right {
    background-image: url("https://moviewatchlist.weebly.com/uploads/8/6/4/2/86429426/green-r_orig.png"); 
}

.green-up {
    background-image: url("https://moviewatchlist.weebly.com/uploads/8/6/4/2/86429426/green-back_orig.png"); 
}

.green-down {
    background-image: url("https://moviewatchlist.weebly.com/uploads/8/6/4/2/86429426/green_orig.png"); 
}

.attack-red {
    height: 35px;
    width: 35px;
    background-size: cover;

    background-image: url("http://moviewatchlist.weebly.com/uploads/8/6/4/2/86429426/fire_orig.png");
}

.attack-blue {
    height: 35px;
    width: 35px;
    background-size: contain;
    background-repeat: no-repeat;

    background-image: url("http://moviewatchlist.weebly.com/uploads/8/6/4/2/86429426/water_orig.png");
}

.attack-green {
    height: 35px;
    width: 35px;
    background-size: cover;
    background-image: url("http://moviewatchlist.weebly.com/uploads/8/6/4/2/86429426/earth_orig.png");
}

/* enemies */

.red-ghost {
    height: 35px;
    width: 35px;
    background-image: url("https://moviewatchlist.weebly.com/uploads/8/6/4/2/86429426/ghost-red_orig.png");
    background-size: contain;
    background-repeat: no-repeat;
}

.blue-ghost {
    height: 35px;
    width: 35px;
    background-image: url("http://moviewatchlist.weebly.com/uploads/8/6/4/2/86429426/ghost-blue_orig.png");
    background-size: contain;
    background-repeat: no-repeat;
}

.green-ghost {
    height: 35px;
    width: 35px;
    background-image: url("https://moviewatchlist.weebly.com/uploads/8/6/4/2/86429426/ghost-green_orig.png");
    background-size: contain;
    background-repeat: no-repeat;
}

/* enemies */

.blue {
	background-color: blue;
    height: 30px;
    width: 30px;
}

.black {
	background-color: transparent;
}

.gameboy {
    height: 710px;
    width: 450px;
    background-color: darkgrey;
}

.half {
    height: 100px;
    width: 205px;
    float: left;
    background-color: darkgrey;
 
    touch-action: manipulation;	
}

.keySectionL {
	margin-top: 40px;
	margin-left: 45px; 
    
    height:140px;
    width: 140px;
	
    touch-action: manipulation;

}

.keySectionR {
	margin-top: 50px;
    margin-left: 48px;
    height: 100px;
    width: 184px;
    
    touch-action: manipulation;
}

.bottomSection {
    height:50px;
    width: 175px;
    padding-top: 630px;
    padding-left: 162px;
    color: lightgrey;
    
    touch-action: manipulation;
}

.key {
    height:43px;
    width: 43px;
    float: left;
    background-color: black;
    text-align: center;
  	font-size: 37px;
    color: #2E2B2B;

    touch-action: manipulation;

}

.kp {
	cursor: pointer;
}

.dot {
	height: 65px;
    width: 65px;
    background-color: black;
    color: #2E2B2B;
    border-radius: 50%;
    display: inline-block;
    text-align: center;
    font-size: 55px;
    float: left;
    cursor: pointer;
    touch-action: manipulation;

}

.small {
  height: 15px;
  width: 35px;
  margin-left: 15px;
}

#hiding {
	display: none;
}

#selectionScreen {
	height: 65px;
    width: 230px;
    
    position: absolute;
    top: 245px;
    left: 105px;
    font-family: 'Public Pixel', sans-serif;
    font-size: 14px;

    
    display: none;
    text-align: left;
    color: white;
}

#pressA {
    position: absolute;
    top: 235px;
    left: 155px;
    color: white;
    font-family: 'Public Pixel', sans-serif;
    font-size: 10px;
    
    display: none;

}

.letter {
    height: 20px;
    width: 20px;
    font-size: 15px;
    text-align: center;
    padding-top: 1px;
    color: green;
    background: white;
    
    opacity: 0.6;
    margin-top: 6px;
    margin-left: 6px;
}

#letterSection {
    position: absolute;
    top: 70px;
    left: 125px;
    color: white;
    
    display: none;
}

.letterBox {
	float: left;
    padding-left: 25px;
    
}

.scoreBox {
	float: left;
    border: solid black 1px;
    background: white;
    color: green;
    width: 12px;
    text-align: center;
}

#WinLose {
    position: absolute;
    top: 200px;
    left: 58px;
    border: solid black 1px;
    background: green;
    color: white;
    font-size: 45px;
    height: 50px;
    width: 350px;
    text-align: center;
    
    display: none;
}

#ruleScreen {
    position: absolute;
    top: 85px;
    left: 81px;
    border: solid black 1px;
    background: purple;
    color: white;
    font-size: 45px;
    height: 300px;
    width: 300px;
    text-align: center;
    font-family: 'Public Pixel', sans-serif;
    
    display: none;
    
}

</style>

<div class="gameboy">
	<div style="float: left; width: 25px; height: 50px;"></div>
    
	<div id="game"></div>
    
    <div id="ruleScreen">
        <div style="font-size: 15px; text-align: left; padding: 10px 15px 0px 15px;">
        The great wizard Rose has sadly met their end. 
        <br>
        But worry not there is still hope.
        <br>
        Through the dark arts one may yet find life after death.
        <br>
        Simply defeat the spirits of the underworld to reclaim your
        place in the mortal world.
        </div>
        <div style="font-size: 20px; color: gold; padding-top: 10px">Continue</div>
    </div>
    
    <div id="selectionScreen">
    	<div id="start">Start Game</div>
        <div id="howToPlay" style="padding-top: 5px;">How To Play</div>
    </div>
    
    <div id="pressA">Press A to Begin</div>
    <div id="letterSection">
    	<div id="one" class="letterBox"></div>
        <div id="two" class="letterBox"></div>
    </div>
    
    <div id="WinLose">You Win!</div>
    
    <div class="half">
    <div class="keySectionL">
		<div class="key" style="background-color: transparent"></div>
		<div class="key kp" onclick="up()"></div>
        <div class="key" style="background-color: transparent"></div>
		<div class="key kp" onclick="move(-1)"></div>
        <div class="key"></div>
		<div class="key kp" onclick="move(1)"></div>
        <div class="key" style="background-color: transparent"></div>
		<div class="key kp" onclick="down()"></div>
        <div class="key" style="background-color: transparent"></div>
    </div>
    </div>
    
    <div class="half">
    <div class="keySectionR">
        <div class="dot" style="margin-top: 40px"
        onclick="attack()">B</div>
        <div class="dot" style="margin-left: 10px"
        onclick="aButton()">A</div>
    </div> 
    </div>
    
    <div class="bottomSection">
        <div class="dot small" onclick="homeScreen()"></div>
        <div class="dot small" onclick="toggleHiding()"></div>
        <br>
        <div style="float:left; padding-left: 18px">Start</div>
        <div style="float:left; padding-left: 21px">Edit</div>

        
    </div>
</div>


<div id="hiding">

<button onclick="startGame()">Start</button>


<p id="myText"></p>

<button onclick="showInfo()">Show Info</button>
<button onclick="toggle()">Toggle Numbering</button>
<button onclick="createGhost()">Create Ghost</button>
<button onclick="clearKill()">Clear Kill</button>
<button onclick="createLetter()">Create Letter</button>
<button onclick="enemyPosition()"> create enemy number</button>

<button onclick="homeScreen()">Home Screen</button>

<br>
<br>

</div>

<script>

let boundary = makeBoundary();
let objects = [];
let direction = "";
let hatColor = "orginal";
let round = 1;
let wordOne = "HAPPY";
let wordOneArr = ["_", "_", "_", "_", "_"];
let wordTwo = "BIRTHDAY";
let wordTwoArr = ["_", "_", "_", "_", "_", "_", "_", "_"];
let code = ["H", "A", "P", "Y", "B", "I", "R", "T", "D"];
let type = "none";

let color = ["red", "blue", "green"];
let colorCounter = -1;

let currentLetter = "";
let player = 25;
let enemy = 100;
let codeSpace = 100;

// Home Screen and Rule Screen
selectionScreen = document.getElementById("selectionScreen");
start = document.getElementById("start");
howToPlay = document.getElementById("howToPlay");
cursor = "";

// empty 
empty = document.getElementById("game").innerHTML;

function startGame() {
	makePixels();
    move(10);
    // Beta //
    document.getElementById("game").style.backgroundImage =    "url('http://moviewatchlist.weebly.com/uploads/8/6/4/2/86429426/grave_orig.png')"; 
    document.getElementById("game").style.backgroundSize = 'contain';
    
    showLetters();
}

function homeScreen() {
	document.getElementById("game").style.backgroundImage = 
    "url('http://moviewatchlist.weebly.com/uploads/8/6/4/2/86429426/home-screen_orig.png')"; 
    document.getElementById("game").style.backgroundSize = 'cover';
    
   	selectionScreen.style.display = "inline-block"; 
    start.style.color = "gold";
    cursor = "start";
}

function up() {
	if (cursor == "howToPlay") {
    	start.style.color = "gold";
        howToPlay.style.color = "white";
        
    	cursor = "start";
    } else if (cursor == "playing") {
    	move(-10);
    }
}

function down() {
	if (cursor == "start") {
    	start.style.color = "white";
        howToPlay.style.color = "gold";
        
    	cursor = "howToPlay";
    } else if (cursor == "playing") {
    	move(10);
    }
}

function aButton() {
	if (cursor == "start") {
    	selectionScreen.style.display = "none";
        
        cursor = "playing";
        showText();
    	startGame();
    } else if (cursor == "playing" && round == 1) {
    	hideText();
    	changeHat();
        createGhost();
        round++;
    } else if (cursor == "playing") {
    	changeHat();    
    } else if (cursor == "howToPlay") {
    	selectionScreen.style.display = "none";
        document.getElementById("ruleScreen").style.display = "inline-block";
        cursor = "howToPlayEnd";
    } else if (cursor == "howToPlayTwo") {    
    // none yet
    } else if (cursor == "howToPlayEnd") {
        selectionScreen.style.display = "inline-block";
        document.getElementById("ruleScreen").style.display = "none";
    	cursor = "howToPlay";    
    }
}

function showText() {
	pressA = document.getElementById("pressA");    
    pressA.style.display = "inline-block";
}

function hideText() {
	pressA = document.getElementById("pressA");    
    pressA.style.display = "none";
}

function makePixels() {
	let gameSpace = document.getElementById("game");  
    gameSpace.innerHTML = "";
    
    for (i=0; i<100; i++) {
    	let pixel = "pixel";
        
    	if (boundary.includes(i) || objects.includes(i)) {
        	pixel += " black";
        }

  		gameSpace.innerHTML += '<div id="P' + i + '" class="' + pixel + 
        '">' + i +'</div>';
    }
}


function move(input) {     
    if (check(input)) { 
      document.getElementById("P" + player).innerHTML = player;

      player += input;
            
      if (input == -1) {
      	  direction = "left";  
      } else if (input == 1) {
          direction = "right";  
      } else if (input == -10) {
      	  direction = "up";        
      } else if (input == 10) {
      	  direction = "down";        
      }
      
      
      document.getElementById("P" + player).innerHTML = '<div class="' + 
      "background " + hatColor + "-" + direction + '">' + player +'</div>';        
    }
    if (player == codeSpace) {
    	// for whatever reason the kill didn't get set back to false
      	// think it was because of the universal checker thing *
    	kill = false;
        //
    	updateLetters();
        if (code.length != 0) {
    		createGhost();
        }
        codeSpace = 100;
    }
}

function check(input) {
	if (!boundary.includes(player + input) && 
    !objects.includes(player + input)) {
 		return true;   
    } else {
    	return false;
    }
}

function makeBoundary() {
	let arr =  [];
	 a = specialForLoop(0, 9, 1);
     b = specialForLoop(0, 90, 10);
     c = specialForLoop(9, 99, 10);
     d = specialForLoop(90, 99, 1);
     
     arr = a.concat(b).concat(c).concat(d);
     return arr;

}

function specialForLoop(vOne, vTwo, vThree) {
	let arr = [];
	for (i=vOne; i<=vTwo; i+=vThree) {
    	arr.push(i);
    }
    return arr;
}

function changeHat() {
	if (colorCounter < 2) {
		colorCounter++;
    } else {
    	colorCounter = 0;
    }
    
    hatColor = color[colorCounter];
    
    document.getElementById("P" + player).innerHTML = '<div class="' + 
    "background " + hatColor + "-" + direction + '">' + player +'</div>'; 
}

function isElementMatch() {
	if (hatColor == "red" && type == "green-ghost") {
    	return true;
    }
    if (hatColor == "blue" && type == "red-ghost") {
    	return true;
    }
    if (hatColor == "green" && type == "blue-ghost") {
    	return true;
    }
}

// ------------Combat-------------

let uniTarget = 0;
let kill = false;

// Checks to see if enemy has been killed 
// Checks if player has letter
// *
setInterval(function() {
	if (uniTarget == enemy && isElementMatch()) {
    	kill = true;
    }
    if (player == enemy) {
    	document.getElementById("WinLose").innerText = "You Lose!";
    	document.getElementById("WinLose").style.backgroundColor = "red";
        document.getElementById("WinLose").style.display = "inline-block";
        cursor = "Home";
        restartHomeScreen();
    }
    if (code.length == 0) {
    	document.getElementById("WinLose").innerText = "You Win!";
    	document.getElementById("WinLose").style.backgroundColor = "green";
        document.getElementById("WinLose").style.display = "inline-block";
        cursor = "Home";        
        restartHomeScreen();    
    }
}, 5);

function clearKill() {
	kill = false;
}


function chooseType() {
	arr = ["red-ghost", "blue-ghost", "green-ghost"];
    randNum = Math.floor(Math.random() * 3);
    
	return arr[randNum];
}

function preGhost(type) {
	if (kill == false) {            
       OGenemy = enemy;

       if (player > enemy) {
           if (player.toString()[0] != enemy.toString()[0]) {
               enemy += 10;
           } else {
               enemy += 1;        
           }
       } else if (player < enemy) {
           if (enemy.toString()[0] != player.toString()[0]) {
               enemy -= 10;
           } else {
               enemy -= 1;        
           }
       } 
       document.getElementById("P" + OGenemy).innerHTML = OGenemy; 

       document.getElementById("P" + enemy).innerHTML = '<div class="' + 
       type + '">' + enemy +'</div>'; 
      }
}

function createGhost() { 
	type = chooseType();    
    enemy = enemyPosition();
    
    ghost = setInterval(function() {
    	preGhost(type);
    	// Stops interval if kill becomes active:
    	if (kill == true) {
        	clearInterval(ghost);  
			kill = false;     
            createLetter();
        }    
        if (cursor != "playing") {
        	clearInterval(ghost);
        }
    }, 700); 
    // used to be 500
}


// -------------------

function rotateDirection(num, dir) { 
    if (dir == "up") {
        document.getElementById("A" + num).style.transform = 'rotate(90deg)';
    } else if (dir == "right") {
        document.getElementById("A" + num).style.transform = 'rotate(180deg)';
    } else if (dir == "down") {
        document.getElementById("A" + num).style.transform = 'rotate(-90deg)';
    }
}

function attack() {    
    let target = 0;
    let movement = 0;
    let end = player.toString().substring(1, 0);
    
    if (direction == "left") {
    	target = player - 1;
        movement = -1;
        
        end = parseInt(end) * 10;
    }
    if (direction == "right") {
    	target = player + 1;
        movement = 1;
        
        end = ((parseInt(end) + 1) * 10) - 1;
    }
    if (direction == "up") {
    	target = player - 10;
        movement = -10;
        
        end = player - (parseInt(end) * 10);
    }
    if (direction == "down") {
    	target = player + 10;
        movement = 10;
        
        end = ((9 - parseInt(end)) * 10) + player;
    }
    
    
    // every half second
    let element = hatColor;
    let ogTarget = target;
    let ogDirection = direction;
    
    var attack = setInterval(function() {
    	// deletes previous attack once interval begins
    	if (target != ogTarget) {
        	previous = target - movement;
        	document.getElementById("P" + previous).innerHTML = '';       
        }
    
    	// creates attacks 
        document.getElementById("P" + target).innerHTML = '<div id="A' + target + 
        '" class="' + "attack-" + element + '">' + target +'</div>'; 
        
        //rotates direction of internal attack div
        rotateDirection(target, ogDirection);

        // updates universal target variable
        uniTarget = target;
        
        // determines next spot
        target += movement;
        
        // Stops interval if hit target
        if (kill == true) {
        	clearInterval(attack);
            previous = target - movement;
            document.getElementById("P" + previous).innerHTML = ''; 
            uniTarget = 0;   
            
            codeSpace = enemy;
            enemy = 100;
        }
        
    	// Stops interval if reaching end or letter:
    	if (target == end || target == codeSpace) {
        	clearInterval(attack);
            
            setTimeout(function() {
                previous = target - movement;
                document.getElementById("P" + previous).innerHTML = ''; 
                uniTarget = 0;
                
            }, 200);
        }        
    }, 200);
    
}

function toggle() {
	let gameSpace = document.getElementById("game");  
	if (gameSpace.style.color == "transparent") {
		gameSpace.style.color = "black";
    } else {
		gameSpace.style.color = "transparent";
    }
}

function toggleHiding() {
	let hiding = document.getElementById("hiding");  
	if (hiding.style.display == "none") {
		hiding.style.display = "inline-block";
    } else {
		hiding.style.display = "none";
    }
}

function showInfo() {
	document.getElementById("myText").innerText = "Hat Color: " + hatColor +
    "\n" + "Direction: " + direction + "\n" + "Position: " + player
    + "\n" + "Cursor: " + cursor + "\n Enemy: " + enemy + "\n Kill:" + kill
    + "\n Code: " + code + "\n Letter: " + codeSpace;
}

function createLetter() {
	if (code.length != 0) {
        randNum = Math.floor(Math.random() * (code.length - 1));
        currentLetter = code[randNum];

        setTimeout(function() {
          document.getElementById("P" + codeSpace).innerHTML = '<div class="' + 
          "dot letter" + '">' + currentLetter +'</div>'; 
        }, 150);
    }
}

function enemyPosition() {
	x = player;

	area = [x - 18, x - 19, x - 20, x - 21, x - 22,
    x - 1, x - 2, x, x + 1, x + 2, 
    x - 8, x - 9, x - 10, x - 11, x - 12,
    x + 8, x + 9, x + 10, x + 11, x + 12,
    x + 18, x + 19, x + 20, x + 21, x + 22];
    
    //area = [
    //x - 1, x, x + 1,
    //x - 9, x - 10, x - 11,
    //x + 9, x + 10, x + 11
    //];
    
    while (area.includes(x) || boundary.includes(x)) {
    	x = Math.floor(Math.random() * 99);
    }
    return x;
}

function showLetters() {
	document.getElementById("letterSection").style.display = "inline-block";
    document.getElementById("one").innerHTML= toDisplay(wordOneArr);
    document.getElementById("two").innerHTML = toDisplay(wordTwoArr);
}

function toDisplay(arr) {
	let string = "";
    
    for (i=0; i<arr.length; i++) {
    	string += '<div class="scoreBox">' + arr[i] + '</div>';
    }

	return string;
}

function updateArray(arr, index) {
	let replace = []
    
    for (i=0; i<arr.length; i++) {
    	if (i == index) {
        	replace.push(currentLetter);
            
            if (currentLetter == "P") {
                replace.push(currentLetter);
            	i++;
            }
        } else {
        	replace.push(arr[i]);
        }
    }
    return replace;
}

function subtractFrom(arr, value) {
	let replace = []
    
    for (i=0; i<arr.length; i++) {
    	if (arr[i] != value) {
        	replace.push(arr[i]);
        }
    }
    return replace;
}

function updateLetters() {
	if (wordOne.includes(currentLetter)) {
    	position = wordOne.indexOf(currentLetter);
        
    	wordOneArr = updateArray(wordOneArr, position);
    } 
    if (wordTwo.includes(currentLetter)) {
    	position = wordTwo.indexOf(currentLetter);
        
    	wordTwoArr = updateArray(wordTwoArr, position);
    }

	code = subtractFrom(code, currentLetter);
	showLetters();
}

function restartHomeScreen() {
	setTimeout(function() {
    	document.getElementById("WinLose").style.display = "none";
        document.getElementById("game").innerHTML = empty;
       	document.getElementById("letterSection").style.display = "none";

        homeScreen();
        
		direction = "";
		hatColor = "orginal";
		round = 1;
		wordOne = "HAPPY";
		wordOneArr = ["_", "_", "_", "_", "_"];
		wordTwo = "BIRTHDAY";
		wordTwoArr = ["_", "_", "_", "_", "_", "_", "_", "_"];
		code = ["H", "A", "P", "Y", "B", "I", "R", "T", "D"];
		colorCounter = -1;
		currentLetter = "";
		player = 25;
		enemy = 100;
		codeSpace = 100;
    
    }, 1000)
}


</script>

</body>
</html>
